{"mappings":"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","sources":["public/js/mapbox.js","public/js/alerts.js","public/js/login.js","public/js/updateSettings.js","public/js/stripe.js","public/js/index.js"],"sourcesContent":["export const displayMap = (locations) => {\n  mapboxgl.accessToken =\n    'pk.eyJ1IjoiY2xhdWRpdWZwb3BhIiwiYSI6ImNsNzZ3eXg0bTAxaXEzcG4zOHM1bW9kZm0ifQ.EDBVn6feuf1gQSlLaScirQ';\n  const map = new mapboxgl.Map({\n    container: 'map', // container ID\n    style: 'mapbox://styles/mapbox/light-v10', // style URL\n    center: [-118.113491, 34.111745],\n    zoom: 9, // starting zoom\n  });\n\n  const bounds = new mapboxgl.LngLatBounds();\n\n  locations.forEach((loc) => {\n    // Create marker\n    const el = document.createElement('div');\n    el.className = 'marker';\n\n    // Add marker\n    new mapboxgl.Marker({\n      element: el,\n      anchor: 'bottom',\n    })\n      .setLngLat(loc.coordinates)\n      .addTo(map);\n\n    // Add popup\n    // new mapboxgl.Popup({\n    //   offset: 30,\n    // })\n    //   .setLngLat(loc.coordinates)\n    //   .setHTML(`<p>Day ${loc.day}: ${loc.description}</p>`)\n    //   .addTo(map);\n    // Extend map bounds to include current location\n    bounds.extend(loc.coordinates);\n  });\n\n  map.fitBounds(bounds, {\n    padding: {\n      top: 200,\n      bottom: 200,\n      left: 100,\n      right: 100,\n    },\n  });\n};\n","export const hideAlert = () => {\n  const el = document.querySelector('.alert');\n  if (el) el.parentElement.removeChild(el);\n};\n\n// type is 'success' or 'error'\nexport const showAlert = (type, msg) => {\n  hideAlert();\n  const markup = `<div class=\"alert alert--${type}\">${msg}</div>`;\n  document.querySelector('body').insertAdjacentHTML('afterbegin', markup);\n  window.setTimeout(hideAlert, 5000);\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nexport const login = async (email, password) => {\n  try {\n    const res = await axios({\n      method: 'POST',\n      url: '/api/v1/users/login',\n      data: {\n        email,\n        password,\n      },\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', 'Logged in successfully');\n      window.setTimeout(() => {\n        location.assign('/');\n      }, 1500);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n\nexport const logout = async () => {\n  try {\n    const res = await axios({\n      method: 'GET',\n      url: '/api/v1/users/logout',\n    });\n\n    if (res.data.status === 'success') location.assign('/');\n  } catch (err) {\n    showAlert('error', 'Error logging out! try again!');\n  }\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\n// type is either password ot data\nexport const updateSettings = async (data, type) => {\n  try {\n    const url =\n      type === 'password'\n        ? '/api/v1/users/updateMyPassword'\n        : '/api/v1/users/updateMe';\n\n    const res = await axios({\n      method: 'PATCH',\n      url,\n      data,\n    });\n\n    if (res.data.status === 'success') {\n      showAlert('success', `${type.toUpperCase()} updated successfully`);\n    }\n  } catch (err) {\n    showAlert('error', err.response.data.message);\n  }\n};\n","import axios from 'axios';\nimport { showAlert } from './alerts';\n\nconst stripe = Stripe(\n  'pk_test_51LfIfhC41VPCXubIkiBCyJKVQ5M1eQ2VK2p6Qcm83mxJNSNpyqHf5sZuYeRp652bclbPSyM5VPpvLYP7XxTHwyOI00EQ4JG9Xa'\n);\n\nexport const bookTour = async (tourId) => {\n  try {\n    // 1) get checkout session from the API\n    const session = await axios({\n      method: 'POST',\n      url: `/api/v1/bookings/create-checkout-session/${tourId}`,\n    });\n\n    // 2) Create checkout form + charge credit card\n    await stripe.redirectToCheckout({\n      sessionId: session.data.session.id,\n    });\n  } catch (err) {\n    showAlert('error, err');\n  }\n};\n","import { displayMap } from './mapbox';\nimport { login, logout } from './login';\nimport { updateSettings } from './updateSettings';\nimport { bookTour } from './stripe';\n\n// DOM Elements\nconst mapBox = document.getElementById('map');\nconst loginForm = document.querySelector('.form--login');\nconst formUserData = document.querySelector('.form-user-data');\nconst formUserPassword = document.querySelector('.form-user-password');\nconst logOutBtn = document.querySelector('.nav__el--logout');\nconst bookBtn = document.getElementById('book-tour');\n\n// Values\n\n// Delegation\nif (mapBox) {\n  const locations = JSON.parse(mapBox.dataset.locations);\n  displayMap(locations);\n}\n\nif (loginForm) {\n  loginForm.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const email = document.getElementById('email').value;\n    const password = document.getElementById('password').value;\n    login(email, password);\n  });\n}\n\nif (logOutBtn) logOutBtn.addEventListener('click', logout);\n\nif (formUserData)\n  formUserData.addEventListener('submit', (e) => {\n    e.preventDefault();\n\n    const form = new FormData();\n    form.append('name', document.getElementById('name').value);\n    form.append('email', document.getElementById('email').value);\n    form.append('photo', document.getElementById('photo').files[0]);\n\n    updateSettings(form, 'data');\n  });\n\nif (formUserPassword)\n  formUserPassword.addEventListener('submit', async (e) => {\n    e.preventDefault();\n    document.querySelector('.btn--save-password').textContent = 'Updating...';\n\n    const passwordCurrent = document.getElementById('password-current').value;\n    const password = document.getElementById('password').value;\n    const passwordConfirm = document.getElementById('password-confirm').value;\n\n    await updateSettings(\n      { passwordCurrent, password, passwordConfirm },\n      'password'\n    );\n\n    document.querySelector('.btn--save-password').textContent = 'Save password';\n    document.getElementById('password-current').value = '';\n    document.getElementById('password').value = '';\n    document.getElementById('password-confirm').value = '';\n  });\n\nif (bookBtn)\n  bookBtn.addEventListener('click', (e) => {\n    e.target.textContent = 'Processing...';\n    const { tourId } = e.target.dataset;\n    bookTour(tourId);\n  });\n"],"names":["$3c4e158d14605c12$export$4c5dd147b21b9176","locations","mapboxgl","accessToken","map","Map","container","style","center","zoom","bounds","LngLatBounds","forEach","loc","el","document","createElement","className","Marker","element","anchor","setLngLat","coordinates","addTo","extend","fitBounds","padding","top","bottom","left","right","$7dc87b7f457e655a$export$516836c6a9dfc573","querySelector","parentElement","removeChild","$7dc87b7f457e655a$export$de026b00723010c1","type","msg","markup","insertAdjacentHTML","window","setTimeout","$bf5b431e6a69fea8$export$596d806903d1f59e","async","email","password","$parcel$interopDefault","$cnf0l$axios","method","url","data","status","location","assign","err","response","message","$955535ce7513e32c$export$f558026a994b6051","toUpperCase","$9fd71c92b6f885af$var$stripe","Stripe","$9fd71c92b6f885af$export$8d5bdbf26681c0c2","tourId","session","redirectToCheckout","sessionId","id","$407eccdc61ba7a94$var$mapBox","getElementById","$407eccdc61ba7a94$var$loginForm","$407eccdc61ba7a94$var$formUserData","$407eccdc61ba7a94$var$formUserPassword","$407eccdc61ba7a94$var$logOutBtn","$407eccdc61ba7a94$var$bookBtn","JSON","parse","dataset","addEventListener","e","preventDefault","value","form","FormData","append","files","textContent","passwordCurrent","passwordConfirm","target"],"version":3,"file":"index.js.map","sourceRoot":"../../../"}